{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/work/kdt01_nextjs/src/app/movie/page.tsx"],"sourcesContent":["'use client'\r\nimport React, { useState, useEffect, useRef } from \"react\"\r\nimport { FaArrowUp, FaArrowDown } from \"react-icons/fa6\"; \r\n// import mv from \"../assets/mvimg.png\"\r\nimport Image from \"next/image\";\r\n\r\ninterface MovieT {\r\n  audiAcc : string;\r\n  audiChange : string;\r\n  audiCnt: string;\r\n  audiInten: string;\r\n  movieCd: string;\r\n  movieNm: string;\r\n  openDt: string;\r\n  rank: string;\r\n  rankInten: string;\r\n  rankOldAndNew: string;\r\n  rnum: string;\r\n  salesAcc: string;\r\n  salesAmt: string;\r\n  salesChange: string;\r\n  salesInten: string;\r\n  salesShare: string;\r\n  scrnCnt: string;\r\n  showCnt: string;\r\n}\r\n\r\nexport default function BoxOffice() {\r\n  //ref\r\n  const refDt = useRef<HTMLInputElement>(null);\r\n  \r\n  //화면에 랜더링 될 상태 변수\r\n  const [tags, setTags] = useState<React.ReactNode[]>([]);\r\n  const [botton, setBotton] = useState<React.ReactNode>();\r\n  const [ndt, setnDt] = useState<string>('');\r\n\r\n  const getYesterday = ():string => {\r\n    const dt = new Date();\r\n    dt.setDate(dt.getDate() - 1);\r\n\r\n    //년도\r\n    const year = dt.getFullYear();\r\n\r\n    //월\r\n    const month = String(dt.getMonth() + 1).padStart(2, '0');\r\n    // month = month < 10 ? '0' + month : month ;\r\n\r\n    //일 \r\n    const day = String(dt.getDate()).padStart(2, '0');\r\n\r\n    return (year + '-' + month + '-' + day);\r\n  }\r\n   \r\n    //일일 박스 오피스 정보 가져오기\r\n    const getFetchData = async() => {\r\n      const mvApiKey = process.env.NEXT_PUBLIC_MV_KEY ;\r\n      const tmdt = ndt.replaceAll('-', '');\r\n      let url = 'https://kobis.or.kr/kobisopenapi/webservice/rest/boxoffice/searchDailyBoxOfficeList.json?';\r\n      url = `${url}key=${mvApiKey}&targetDt=${tmdt}`;\r\n      console.log(\"url\", url);\r\n      // console.log(refDt.current.value);\r\n      // console.log(url)\r\n      const resp = await fetch(url);\r\n      const data = await resp.json();\r\n      const boxList = data.boxOfficeResult.dailyBoxOfficeList;\r\n      console.log(boxList)\r\n      \r\n      const tm = boxList.map((item:MovieT) =>  <tr key={item.movieCd} onClick={() => handleClick(item)}\r\n                                          className=\"bg-white border-b dark:bg-gray-800 dark:border-gray-700 border-gray-200\r\n                                                    hover:bg-gray-50 dark:hover:bg-gray-600 hover:cursor-pointer hover:font-bold\">\r\n                                      <td className=\" px-6 p-4 text-center\">\r\n                                        {item.rank}\r\n                                      </td>\r\n                                      <td className=\" px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white\">\r\n                                        {item.movieNm}\r\n                                      </td>\r\n                                      <td className=\" px-6 py-4 text-right\">\r\n                                        {parseInt(item.salesAmt).toLocaleString()}\r\n                                      </td>\r\n                                      <td className=\" px-6 py-4 text-right\">\r\n                                        {parseInt(item.audiCnt).toLocaleString()}\r\n                                      </td>\r\n                                      <td className=\" px-6 py-4 text-right\">\r\n                                        {parseInt(item.salesAcc).toLocaleString()}\r\n                                      </td>\r\n                                      <td className=\" px-6 py-4 text-right\">\r\n                                        {parseInt(item.audiAcc).toLocaleString()}\r\n                                      </td>\r\n                                      <td className=\"w-full px-6 py-4 text-center inline-flex justify-center items-center\" >\r\n                                        {parseInt(item.rankInten) > 0 ? <span className=\"text-red-600\"><FaArrowUp /></span> \r\n                                          : parseInt(item.rankInten) < 0 ? <span className=\"text-blue-600\"><FaArrowDown /></span> : ''}\r\n                                        &nbsp;{item.rankInten == \"0\" ? '-' : Math.abs(parseInt(item.rankInten))}                                    \r\n                                      </td>\r\n                                    </tr>)\r\n      setTags(tm);    \r\n    }\r\n    const handleClick = (item:MovieT) => {\r\n      const bt:React.ReactNode = <tr className=\"border-b bg-gray-100 dark:bg-gray-800 dark:border-gray-700 border-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600\">\r\n                <td className=\"px-6 p-4 text-center font-bold text-black\" colSpan={7}>\r\n                  [{item.rankOldAndNew} {item.openDt}] <span className=\"text-blue-600\">{item.movieNm}</span>,  &nbsp;상영한 스크린 수: {item.scrnCnt},  &nbsp;상영횟수: {item.showCnt}\r\n                </td>\r\n              </tr>\r\n      setBotton(bt);\r\n    }\r\n    const dateChng = ()=>{\r\n      if(!refDt.current) return;\r\n      setnDt(refDt.current?.value);\r\n      setBotton('');\r\n    }\r\n    //컴포넌트가 실행 시 한 번 fetch\r\n    useEffect(()=>{\r\n        setnDt(getYesterday());\r\n        if(refDt.current)\r\n          refDt.current.max = getYesterday();\r\n    }, []);\r\n\r\n    useEffect(()=>{\r\n      if(!ndt) return;\r\n      if(refDt.current)\r\n        refDt.current.value = ndt;\r\n      \r\n      getFetchData();\r\n    }, [ndt]);\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"w-11/12\">\r\n      <h2 className=\"text-2xl font-bold text-left ml-5 text-gray-700 flex flex-row justify-start items-center\">\r\n        <span className=\"w-15\"><Image src=\"/mvimg.png\" width={50} height={50} alt=\"mvimg\" className=\"tilt-animation\"/></span>&nbsp;Box Office\r\n      </h2>\r\n      <div className=\"flex justify-end items-center font-bold text-gray-700\">\r\n      <input type=\"date\" ref={refDt} onChange={dateChng} className=\"mb-5 mx-5 px-4 py-1 bg-white border border-gray-200 rounded-lg shadow-sm \r\n                            focus:outline-none focus:ring-2 focus:ring-gray-300 focus:border-gray-400 cursor-pointer\"/>\r\n      </div>\r\n      <table className=\"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400\">\r\n        <thead className=\"text-sm text-gray-700 uppercase bg-gray-100 dark:bg-gray-700 dark:text-gray-400\">\r\n          <tr>\r\n            <td className=\"w-20 font-bold px-6 py-3 text-center\">\r\n              순위\r\n            </td>\r\n            <th className=\"min-w-auto px-6 py-3 text-center\">\r\n              영화명\r\n            </th>\r\n            <th className=\"min-w-auto px-6 py-3 text-center w-1/7\">\r\n              매출액\r\n            </th>\r\n            <th className=\"min-w-auto  px-6 py-3 text-center w-1/7\">\r\n              관객수\r\n            </th>\r\n            <th className=\"min-w-auto  px-6 py-3 text-center w-1/7\">\r\n              누적 매출액\r\n            </th>\r\n            <th className=\"min-w-auto  px-6 py-3 text-center w-1/7\">\r\n              누적 관객수\r\n            </th>\r\n            <th className=\"min-w-auto  px-6 py-3 text-center w-24\">\r\n              증감율\r\n            </th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {tags}          \r\n        </tbody>\r\n        <tfoot>\r\n          {botton}         \r\n        </tfoot>\r\n      </table>\r\n    \r\n  </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}